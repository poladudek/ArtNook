<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArtNook</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>

    <nav>
        <a class="name" href="index.html">ART NOOK</a>
        <div class="tabs">
            <a href="screenings.html">Repertuar</a>
            <a id="authLink" href="login.html">Zaloguj siÄ™</a>
        </div>
    </nav>

    <section class="hero">
        <h1>KINO STUDYJNE</h1>
        <p>Zanurz siÄ™ w historiÄ™. PrzeÅ¼yj jÄ… sam.</p>
    </section>

    <h2 class="section-title">NAJNOWSZE FILMY</h2>

    <div class="movies-scroll">
        <div class="movies-container" id="moviesContainer">
            <!-- Dynamic load: movies -->
        </div>
    </div>
    <section class="about">
  <div class="about-light"></div>
  <div class="about-inner">
    <h1 style="font-size: 32px;
    font-weight: 200;
    letter-spacing: 2px;
    margin-bottom: 20px;">O NAS</h1>
    <p class="about-text">
    Od starannie wyselekcjonowanego repertuaru, przez komfortowe sale kinowe, po wyjÄ…tkowÄ… atmosferÄ™. ArtNook to kino, ktÃ³rego seanse zostajÄ… w pamiÄ™ci na dÅ‚ugo.
  </div>
</section>

    <footer>
        <p>&copy; 2024 ArtNook. Wszystkie prawa zastrzeÅ¼one.</p>
    </footer>

    <script>

const container = document.getElementById("moviesContainer");

async function loadMovies() {
    try {
        const response = await fetch(`http://localhost:3000/api/movies`);
        const result = await response.json();
        const movies = result.data;

        container.innerHTML = "";

        movies.slice(0, 7).forEach(movie => {
            const card = document.createElement("div");
            card.classList.add("movie-card");

            const img = document.createElement("img");
            img.classList.add("movie-poster");
            img.src = `http://localhost:3000/${movie.img_path}`;
            img.alt = movie.title;
            card.append(img);
            container.appendChild(card);
        });

    } catch (error) {
        console.error("BÅ‚Ä…d pobierania filmÃ³w:", error);
        container.innerHTML = "<p>Nie udaÅ‚o siÄ™ zaÅ‚adowaÄ‡ filmÃ³w.</p>";
    }
}

loadMovies();


async function updateAuthLink() {
    const authLink = document.getElementById('authLink');
    const tabs = document.querySelector('.tabs');
    const token = localStorage.getItem('token');
    if (!authLink) return;
    if (token) {
        authLink.href = 'user.html';
        authLink.innerHTML = '<span class="user-icon">ðŸ‘¤</span>';
        authLink.title = 'Panel uÅ¼ytkownika';

        try {
            const res = await fetch('http://localhost:3000/api/me', {
                headers: {Authorization: 'Bearer ' + token}
            });
            if (res.ok) {
                const data = await res.json();
                if (data.user && data.user.role === 'admin') {
                    const adminLink = document.createElement('a');
                    adminLink.href = 'admin.html';
                    adminLink.textContent = 'Admin';
                    tabs.insertBefore(adminLink, authLink);
                }
            }
        } catch (err) {
            console.error('Could not verify user role', err);
        }
    } else {
        authLink.href = 'login.html';
        authLink.textContent = 'Zaloguj siÄ™';
    }
}
updateAuthLink();
</script>

</body>
</html>
